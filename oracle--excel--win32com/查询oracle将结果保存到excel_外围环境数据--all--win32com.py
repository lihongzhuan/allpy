# -*- coding: utf-8 -*-
"""
Created on Mon Dec 21 14:51:20 2020

@author: 0100904


1	Fix.D221_AHU411_TE.F_CV	AHU411 拉丝间一层（9.1期）温度(D221)	2020-12-16 00:10:31	18	Good
2	Fix.D221_AHU411_ME.F_CV	AHU411 拉丝间一层（9.1期）湿度(D221)	2020-12-16 00:10:31	47	Good
3	Fix.D221_AHU416_TE.F_CV	AHU416 拉丝间一层（9.2期）温度(D221)	2020-12-16 00:10:31	20	Good
4	Fix.D221_AHU416_ME.F_CV	AHU416 拉丝间一层（9.2期）湿度(D221)	2020-12-16 00:10:31	52	Good
5	Fix.D221_AHU412_TE.F_CV	AHU412 拉丝间二层（9.1期）温度(D221)	2020-12-16 00:10:31	18	Good
6	Fix.D221_AHU412_ME.F_CV	AHU412 拉丝间二层（9.1期）湿度(D221)	2020-12-16 00:10:31	64	Good
7	Fix.D221_AHU417_TE.F_CV	AHU417 拉丝间二层（9.2期）温度(D221)	2020-12-16 00:10:31	20	Good
8	Fix.D221_AHU417_ME.F_CV	AHU417 拉丝间二层（9.2期）湿度(D221)	2020-12-16 00:10:31	56	Good
9	Fix.D223_AHU413_TE.F_CV	AHU413 拉丝间三层（9.1期）温度(D223)	2020-12-16 00:10:31	18	Good
10	Fix.D223_AHU413_ME.F_CV	AHU413 拉丝间三层（9.1期）湿度(D223)	2020-12-16 00:10:31	56	Good
11	Fix.D223_AHU418_TE.F_CV	AHU418 拉丝间三层（9.2期）温度(D223)	2020-12-16 00:10:31	21	Good
12	Fix.D223_AHU418_ME.F_CV	AHU418 拉丝间三层（9.2期）湿度(D223)	2020-12-16 00:10:31	52	Good
13	Fix.D223_AHU414_TE.F_CV	AHU414 拉丝间四层（9.1期）温度(D223)	2020-12-16 00:10:31	21	Good
14	Fix.D223_AHU414_ME.F_CV	AHU414 拉丝间四层（9.1期）湿度(D223)	2020-12-16 00:10:31	49	Good
15	Fix.D223_AHU419_TE.F_CV	AHU419 拉丝间四层（9.2期）温度(D223)	2020-12-16 00:10:31	21	Good
16	Fix.D223_AHU419_ME.F_CV	AHU419 拉丝间四层（9.2期）湿度(D223)	2020-12-16 00:10:31	49	Good
17	Fix.D224_AHU415_TE.F_CV	AHU415 拉丝间五层（9.1期）温度(D224)	2020-12-16 00:10:31	27	Good
18	Fix.D224_AHU415_ME.F_CV	AHU415 拉丝间五层（9.1期）湿度(D224)	2020-12-16 00:10:31	31	Good
19	Fix.D224_AHU420_TE.F_CV	AHU420 拉丝间五层（9.2期）温度(D224)	2020-12-16 00:10:31	28	Good
20	Fix.D224_AHU420_ME.F_CV	AHU420 拉丝间五层（9.2期）湿度(D224)	2020-12-16 00:10:31	29	Good
21	Fix.JJD11_1_3.F_CV	（通道11）九期拉丝 T41/3F 0.3微米 一分钟	2020-12-16 00:10:31	320	Good
22	Fix.JJD12_1_3.F_CV	（通道12）九期拉丝 T41/6F 0.3微米 一分钟	2020-12-16 00:10:31	238	Good
23	Fix.JJD13_1_3.F_CV	（通道13）九期拉丝 T41/9F 0.3微米 一分钟	2020-12-16 00:10:31	0	Good
24	Fix.JJD14_1_3.F_CV	（通道14）九期拉丝 T42/3F 0.3微米 一分钟	2020-12-16 00:10:31	0	Good
25	Fix.JJD15_1_3.F_CV	（通道15）九期拉丝 T42/6F 0.3微米 一分钟	2020-12-16 00:10:31	0	Good
26	Fix.JJD16_1_3.F_CV	（通道16）九期拉丝 T42/9F 0.3微米 一分钟	2020-12-16 00:10:31	0	Good
27	Fix.JJD17_1_3.F_CV	（通道17）九期拉丝 T45/3F 0.3微米 一分钟	2020-12-16 00:10:31	0	Good
28	Fix.JJD18_1_3.F_CV	（通道18）九期拉丝 T45/7F 0.3微米 一分钟	2020-12-16 00:10:31	0	Good
29	Fix.JJD19_1_3.F_CV	（通道19）九期拉丝 T45/9F 0.3微米 一分钟	2020-12-16 00:10:31	0	Good
30	Fix.JJD20_1_3.F_CV	（通道20）九期拉丝 T46/3F 0.3微米 一分钟	2020-12-16 00:10:31	0	Good
31	Fix.JJD21_1_3.F_CV	（通道21）九期拉丝 T46/7F 0.3微米 一分钟	2020-12-16 00:10:31	0	Good
32	Fix.JJD22_1_3.F_CV	（通道22）九期拉丝 T46/9F 0.3微米 一分钟	2020-12-16 00:10:31	0	Good
33	Fix.JJD11_1_5.F_CV	（通道11）九期拉丝 T41/3F 0.5微米 一分钟	2020-12-16 00:10:31	149	Good
34	Fix.JJD12_1_5.F_CV	（通道12）九期拉丝 T41/6F 0.5微米 一分钟	2020-12-16 00:10:31	148	Good
35	Fix.JJD13_1_5.F_CV	（通道13）九期拉丝 T41/9F 0.5微米 一分钟	2020-12-16 00:10:31	0	Good
36	Fix.JJD14_1_5.F_CV	（通道14）九期拉丝 T42/3F 0.5微米 一分钟	2020-12-16 00:10:31	0	Good
37	Fix.JJD15_1_5.F_CV	（通道15）九期拉丝 T42/6F 0.5微米 一分钟	2020-12-16 00:10:31	0	Good
38	Fix.JJD16_1_5.F_CV	（通道16）九期拉丝 T42/9F 0.5微米 一分钟	2020-12-16 00:10:31	0	Good
39	Fix.JJD17_1_5.F_CV	（通道17）九期拉丝 T45/3F 0.5微米 一分钟	2020-12-16 00:10:31	0	Good
40	Fix.JJD18_1_5.F_CV	（通道18）九期拉丝 T45/7F 0.5微米 一分钟	2020-12-16 00:10:31	0	Good
41	Fix.JJD19_1_5.F_CV	（通道19）九期拉丝 T45/9F 0.5微米 一分钟	2020-12-16 00:10:31	0	Good
42	Fix.JJD20_1_5.F_CV	（通道20）九期拉丝 T46/3F 0.5微米 一分钟	2020-12-16 00:10:31	0	Good
43	Fix.JJD21_1_5.F_CV	（通道21）九期拉丝 T46/7F 0.5微米 一分钟	2020-12-16 00:10:31	0	Good
44	Fix.JJD22_1_5.F_CV	（通道22）九期拉丝 T46/9F 0.5微米 一分钟	2020-12-16 00:10:31	0	Good
45	Fix.JJD11_10_3.F_CV	（通道11）九期拉丝 T41/3F 0.3微米 十分钟	2020-12-16 00:10:31	2771	Good
46	Fix.JJD12_10_3.F_CV	（通道12）九期拉丝 T41/6F 0.3微米 十分钟	2020-12-16 00:10:31	1347	Good
47	Fix.JJD13_10_3.F_CV	（通道13）九期拉丝 T41/9F 0.3微米 十分钟	2020-12-16 00:10:31	0	Good
48	Fix.JJD14_10_3.F_CV	（通道14）九期拉丝 T42/3F 0.3微米 十分钟	2020-12-16 00:10:31	0	Good
49	Fix.JJD15_10_3.F_CV	（通道15）九期拉丝 T42/6F 0.3微米 十分钟	2020-12-16 00:10:31	0	Good
50	Fix.JJD16_10_3.F_CV	（通道16）九期拉丝 T42/9F 0.3微米 十分钟	2020-12-16 00:10:31	0	Good
51	Fix.JJD17_10_3.F_CV	（通道17）九期拉丝 T45/3F 0.3微米 十分钟	2020-12-16 00:10:31	0	Good
52	Fix.JJD18_10_3.F_CV	（通道18）九期拉丝 T45/7F 0.3微米 十分钟	2020-12-16 00:10:31	0	Good
53	Fix.JJD19_10_3.F_CV	（通道19）九期拉丝 T45/9F 0.3微米 十分钟	2020-12-16 00:10:31	0	Good
54	Fix.JJD20_10_3.F_CV	（通道20）九期拉丝 T46/3F 0.3微米 十分钟	2020-12-16 00:10:31	0	Good
55	Fix.JJD21_10_3.F_CV	（通道21）九期拉丝 T46/7F 0.3微米 十分钟	2020-12-16 00:10:31	0	Good
56	Fix.JJD22_10_3.F_CV	（通道22）九期拉丝 T46/9F 0.3微米 十分钟	2020-12-16 00:10:31	0	Good
57	Fix.JJD11_10_5.F_CV	（通道11）九期拉丝 T41/3F 0.5微米 十分钟	2020-12-16 00:10:31	1273	Good
58	Fix.JJD12_10_5.F_CV	（通道12）九期拉丝 T41/6F 0.5微米 十分钟	2020-12-16 00:10:31	747	Good
59	Fix.JJD13_10_5.F_CV	（通道13）九期拉丝 T41/9F 0.5微米 十分钟	2020-12-16 00:10:31	0	Good
60	Fix.JJD14_10_5.F_CV	（通道14）九期拉丝 T42/3F 0.5微米 十分钟	2020-12-16 00:10:31	0	Good
61	Fix.JJD15_10_5.F_CV	（通道15）九期拉丝 T42/6F 0.5微米 十分钟	2020-12-16 00:10:31	0	Good
62	Fix.JJD16_10_5.F_CV	（通道16）九期拉丝 T42/9F 0.5微米 十分钟	2020-12-16 00:10:31	0	Good
63	Fix.JJD17_10_5.F_CV	（通道17）九期拉丝 T45/3F 0.5微米 十分钟	2020-12-16 00:10:31	0	Good
64	Fix.JJD18_10_5.F_CV	（通道18）九期拉丝 T45/7F 0.5微米 十分钟	2020-12-16 00:10:31	0	Good
65	Fix.JJD19_10_5.F_CV	（通道19）九期拉丝 T45/9F 0.5微米 十分钟	2020-12-16 00:10:31	0	Good
66	Fix.JJD20_10_5.F_CV	（通道20）九期拉丝 T46/3F 0.5微米 十分钟	2020-12-16 00:10:31	0	Good
67	Fix.JJD21_10_5.F_CV	（通道21）九期拉丝 T46/7F 0.5微米 十分钟	2020-12-16 00:10:31	0	Good
68	Fix.JJD22_10_5.F_CV	（通道22）九期拉丝 T46/9F 0.5微米 十分钟	2020-12-16 00:10:31	0	Good
69	Fix.DT1_TE2.F_CV	拉丝塔六期一层温度2 (DDC211)	2020-12-16 00:10:31	21	Good
70	Fix.DT1_TE3.F_CV	拉丝塔六期一层温度3 (DDC211)	2020-12-16 00:10:31	19	Good
71	Fix.DT1_TE4.F_CV	拉丝塔六期一层温度4 (DDC211)	2020-12-16 00:10:31	20	Good
72	Fix.DT1_HE2.F_CV	拉丝塔六期一层湿度(DDC211)	2020-12-16 00:10:31	53	Good
73	Fix.DT1_TE1.F_CV	拉丝塔七期一层温度1 (DDC211)	2020-12-16 00:10:31	21	Good
74	Fix.DT1_TE5.F_CV	拉丝塔七期一层温度5 (DDC211)	2020-12-16 00:10:31	20	Good
75	Fix.DT1_TE6.F_CV	拉丝塔七期一层温度6 (DDC211)	2020-12-16 00:10:31	21	Good
76	Fix.DT1_ME.F_CV	拉丝塔七期一层湿度 (DDC211)	2020-12-16 00:10:31	51	Good
77	Fix.DT2_TE2.F_CV	拉丝塔六期二层温度2 (DDC211)	2020-12-16 00:10:31	20	Good
78	Fix.DT2_TE3.F_CV	拉丝塔六期二层温度3 (DDC212)	2020-12-16 00:10:31	22	Good
79	Fix.DT2_TE4.F_CV	拉丝塔六期二层温度4 (DDC212)	2020-12-16 00:10:31	22	Good
80	Fix.DT2_HE1.F_CV	拉丝塔六期二层湿度(DDC211)	2020-12-16 00:10:31	39	Good
81	Fix.DT2_TE5.F_CV	拉丝塔七期二层温度5 (DDC212)	2020-12-16 00:10:31	25	Good
82	Fix.DT2_TE6.F_CV	拉丝塔七期二层温度6 (DDC212)	2020-12-16 00:10:31	25	Good
83	Fix.DT2_HE2.F_CV	拉丝塔七期二层湿度(DDC211)	2020-12-16 00:10:31	45	Good
84	Fix.DT3_TE1.F_CV	拉丝塔六期三层温度1 (DDC212)	2020-12-16 00:10:31	20	Good
85	Fix.DT3_TE3.F_CV	拉丝塔六期三层温度3 (DDC213)	2020-12-16 00:10:31	22	Good
86	Fix.DT3_ME.F_CV	拉丝塔三层六期湿度 (DDC212)	2020-12-16 00:10:31	53	Good
87	Fix.DT3_TE4.F_CV	拉丝塔七期三层温度4 (DDC213)	2020-12-16 00:10:31	23	Good
88	Fix.DT3_TE5.F_CV	拉丝塔七期三层温度5 (DDC213)	2020-12-16 00:10:31	21	Good
89	Fix.DT3_TE6.F_CV	拉丝塔七期三层温度6 (DDC213)	2020-12-16 00:10:31	21	Good
90	Fix.DT3_HE1.F_CV	拉丝塔七期三层湿度(DDC213)	2020-12-16 00:10:31	52	Good
91	Fix.DT4_TE1.F_CV	拉丝塔六期四层温度1 (DDC214)	2020-12-16 00:10:31	27	Good
92	Fix.DT4_TE2.F_CV	拉丝塔六期四层温度2 (DDC214)	2020-12-16 00:10:31	20	Good
93	Fix.DT4_TE4.F_CV	拉丝塔六期四层温度4 (DDC214)	2020-12-16 00:10:31	20	Good
94	Fix.DT4_HE2.F_CV	拉丝塔六期四层湿度(DDC213)	2020-12-16 00:10:31	49	Good
95	Fix.DT4_TE3.F_CV	拉丝塔七期四层温度3 (DDC214)	2020-12-16 00:10:31	20	Good
96	Fix.DT4_TE5.F_CV	拉丝塔七期四层温度5 (DDC214)	2020-12-16 00:10:31	19	Good
97	Fix.DT4_TE6.F_CV	拉丝塔七期四层温度6 (DDC214)	2020-12-16 00:10:31	21	Good
98	Fix.DT4_HE1.F_CV	拉丝塔七期四层湿度(DDC213)	2020-12-16 00:10:31	48	Good
99	Fix.DT5_TE1.F_CV	拉丝塔六期五层温度1 (DDC206)	2020-12-16 00:10:31	24	Good
100	Fix.DT5_TE2.F_CV	拉丝塔六期五层温度2 (DDC206)	2020-12-16 00:10:31	22	Good
101	Fix.DT5_TE3.F_CV	拉丝塔六期五层温度3 (DDC206)	2020-12-16 00:10:31	16	Good
102	Fix.DT5_RH.F_CV	拉丝塔六期五层湿度 (DDC206)	2020-12-16 00:10:31	40	Good
103	Fix.DT5_TE4.F_CV	拉丝塔七期五层温度4 (DDC206)	2020-12-16 00:10:31	24	Good
104	Fix.DT5_TE5.F_CV	拉丝塔七期五层温度5 (DDC206)	2020-12-16 00:10:31	20	Good
105	Fix.DT5_TE6.F_CV	拉丝塔七期五层温度6 (DDC206)	2020-12-16 00:10:31	17	Good
106	Fix.DT5_HE1.F_CV	拉丝塔七期五层湿度(DDC213)	2020-12-16 00:10:31	43	Good
107	Fix.SX_TE1.F_CV	筛选间温度1 (DDC208)	2020-12-16 00:10:31	22	Good
108	Fix.SX_TE2.F_CV	筛选间温度2 (DDC208)	2020-12-16 00:10:31	24	Good
109	Fix.SX_TE3.F_CV	筛选间温度3 (DDC208)	2020-12-16 00:10:31	23	Good
110	Fix.SX_TE4.F_CV	筛选间温度4 (DDC208)	2020-12-16 00:10:31	25	Good
111	Fix.SX_ME.F_CV	筛选间湿度 (DDC208)	2020-12-16 00:10:31	49	Good
112	Fix.CS_TE1.F_CV	测试间温度1 (DDC209)	2020-12-16 00:10:31	23	Good
113	Fix.CS_TE2.F_CV	测试间温度2 (DDC209)	2020-12-16 00:10:31	22	Good
114	Fix.CS_TE3.F_CV	测试间温度3 (DDC209)	2020-12-16 00:10:31	25	Good
115	Fix.CS_TE4.F_CV	测试间温度4 (DDC209)	2020-12-16 00:10:31	25	Good
116	Fix.CS_TE5.F_CV	测试间温度5 (DDC209)	2020-12-16 00:10:31	24	Good
117	Fix.CS_ME.F_CV	测试间湿度 (DDC209)	2020-12-16 00:10:31	36	Good
118	Fix.BZ_TE2.F_CV	包装间温度2 (DDC210)	2020-12-16 00:10:31	23	Good
119	Fix.BZ_TE3.F_CV	包装间温度3 (DDC210)	2020-12-16 00:10:31	23	Good
120	Fix.BZ_ME.F_CV	包装间湿度 (DDC210)	2020-12-16 00:10:31	27	Good
121	Fix.SPC_TEST_ROOM_T.F_CV	特殊设备测试间温度(DDC211)	2020-12-16 00:10:31	23	Good
122	Fix.SPC_TEST_ROOM_H.F_CV	特殊设备测试间湿度(DDC211)	2020-12-16 00:10:31	53	Good
123	Fix.D209_DQJ_TE.F_CV	氘气室温度 (DDC209)	2020-12-16 00:10:31	22	Good
124	Fix.D209_DQJ_RH.F_CV	氘气室湿度 (DDC209)	2020-12-16 00:10:31	20	Good
125	Fix.JJD310_3.F_CV	9.1期三层洁净度 0.3微米 一分钟	2020-12-16 00:10:31	1120	Good
126	Fix.JJD310_5.F_CV	9.1期三层洁净度 0.5微米 一分钟	2020-12-16 00:10:31	143	Good
127	Fix.JJD310_10.F_CV	9.1期三层洁净度 1微米 一分钟	2020-12-16 00:10:31	19	Good
128	Fix.JJD310_50.F_CV	9.1期三层洁净度 5微米 一分钟	2020-12-16 00:10:31	4	Good
129	FIX.D235_COATING_ROOM_TE.F_CV	coating烘房温度	2020-12-16 00:10:31	54.40000153	Good
131	FIX.CA_HE_FLOW_FIBER.F_CV	光纤部氦气流量	2020-12-16 00:10:31	15.33871841	Good
132	FIX.C4_FT212_FLOW.F_CV	光纤部氮气流量Nm3/h	2020-12-16 00:10:31	410.69833374	Good
133	FIX.C4_FT212_FLOW_T.F_CV	光纤部氮气流量Nm3	2020-12-16 00:10:31	72222.0546875	Good










NumberFormatLocal = “@” #设置A1单元格为文本格式

NumberFormatLocal = “yyyy/m/d” #设置B1单元格为日期格式

NumberFormatLocal = “[$-F400]h🇲🇲ss AM/PM” #设置C1单元格为时间格式

NumberFormatLocal = “0.00%” #设置D1单元格为百分比格式

NumberFormatLocal = “0.00E+00” #设置E1单元格为[科学记数法]

NumberFormatLocal = “G/通用格式” #设置F1单元格为常规格式





"""

import os
import platform
import xlsxwriter
import cx_Oracle as cx
import time
import win32com
import random

##======================设置oracle数据库相关信息
LOCATION = r"e:\oracle\client"
print("ARCH:", platform.architecture())
print("FILES AT LOCATION:")
for name in os.listdir(LOCATION):
    print(name)
os.environ["PATH"] = LOCATION + ";" + os.environ["PATH"]



## =====================链接数据库
dsn = cx.makedsn('10.46.2.221', 1521, 'ihistorian')
connection = cx.connect('ih', 'ih', dsn)
cursor = connection.cursor() 

print("=======connect  to oracle=========")
print(cursor.description)
## =======================创建workbook，设定工作表相关参数======================================
# sql1 = "*"
# sql2 = "select * from user_tables"
# cursor.execute(sql2)


bookname = "d:/forAllinOne/外围表头读数.xlsx"
book = xlsxwriter.Workbook(bookname)
forma = book.add_format({'num_format':'yyyy-mm-dd hh:mm:ss','font_size': 9, 'align': 'center','valign': 'vcenter'})
forma_head= book.add_format({'num_format':'#,##0.000','font_size': 9, 'align': 'center','valign': 'vcenter'})
forma_int = book.add_format({'num_format': '0'})
forma_decimal = book.add_format({'num_format': '#,##0.00'})
forma_date = book.add_format({'num_format':'yyyy-mm-dd hh:mm:ss'})
forma_percentage = book.add_format({'num_format': '0.0%'})
forma_char = book.add_format({'num_format': 's%'})
forma_lists = [forma_int,forma_char,forma_decimal,forma_date,forma_decimal,forma_char]
# ，forma_date,forma_decimal,forma_char
print(forma_lists)


#=++++++++++++++++++++Z1 START ===========================

sheetname = r'光纤部N2每小时使用累计量'
print("=======start write "+sheetname+"到excel")

sql1 = '''
SELECT
	* 
FROM
	IHTODB.TBL_IHTODB a 
WHERE
	a.Date_time BETWEEN to_date( '2020-12-1 00:00:00', 'YYYY-MM-DD HH24:MI:SS' ) 
	AND to_date( '2020-12-23:00:00', 'YYYY-MM-DD HH24:MI:SS' ) 
	AND to_char( Date_time, 'MI' ) = '00'
	AND ( tag_index = 133 ) 
ORDER BY
	date_time ASC,
	tag_index ASC


'''

## =======================执行SQL

cursor.execute(sql1)
alldata = cursor.fetchall() 
# print(row)
print("========SUCCESS to get alldata from oracle =========",sheetname)


# ====================查询结果写入excel
t = time.strftime('%Y.%m.%d',time.localtime(time.time()))
ran = random.randint(0,99)
print(t,ran)


print(bookname)


from win32com.client import Dispatch
import os
pwd = os.getcwd()
xlApp = Dispatch('Excel.Application')
xlApp.Visible = 0
xlBook = xlApp.Workbooks.Add()
xlApp.Worksheets.Add().Name = sheetname
xlSheet = xlApp.Worksheets(sheetname)
x2Sheet = xlApp.Worksheets('Sheet1')
x2Sheet.Cells(1,1).Value = 'title'
x2Sheet.Cells(2,1).Value = 123




















# sheet1 = book.add_worksheet(sheetname)
#  # Add a bold format to use to highlight cells. 设置粗体，默认是False
# bold = book.add_format({'bold': True})
#  # Add a number format for cells with money.  定义数字格式
# money = book.add_format({'num_format': '$#,##0'})
#  # Add a number format for cells with money.  定义日期格式
# date_format = book.add_format({'num_format': 'd mmmm yyyy'})

# print(cursor.description)

fields = [field[0] for field in cursor.description]  # 获取所有字段名    
# print(fields)
# print(type(fields))
i = 1
for col,field in enumerate(fields):
    i = i+1
    print(col)
    print(field)
    print(fields)
    print(fields[1])
    print(type(fields))
    # print(i)
    # xlSheet.Rows(1).Value = fields  # ok
    xlSheet.Cells(1,col+1).Value = fields[col]
print ("========success 完成写表头=========")    

row = 1
for data in alldata:
    #print(data)
#     print ("d%",row) 
    for col,field in enumerate(data):
        # print(type(field))
        # # print(field)
        # print(field[col-1])
        # # print（field）
        # print("添加的行，列为：",row,col)
        
        
        
        xlSheet.Cells(row+1,col+1).Value = data[col]
        xlSheet.Cells(row+1,col+1).Font.Size = 9
        xlSheet.Cells(row+1,col+1).Name = "Arial"
        # xlSheet.Cells(row+1,col+1).Borders.LineStyle = xlDouble
        xlSheet.Cells(row+1,col+1).ColumnWidth = 15
        # xlSheet.Cells(row+1,col+1).Font.Size = 9
        # xlSheet.Cells(row+1,col+1).Font.Size = 9
        # print(type(row))
        # print(sheet1[row,col].value)
        # print(forma_lists[col-1])
        # print（field）
        # print("添加的行，列为：",row,col)
    row += 1
    
print("此表的行，列为：",row,col)

# # sheet.set_column(1,None,forma)
# sheet1.set_column("A:Z", 15)    #设置列宽度
# sheet1.set_row(0, 10)    #设置行高度
# # format = book.add_format({'color':'red'})    #获取单元格属性
# #{'bold': True, 'font_size': 14, 'align': 'center','valign': 'vcenter','border':1, 'color':'red', 'bg_color':'blue'}
# # dir(format)    #可以显示属性的种类
# # format.set_bold("A:A")    #设置粗体
# # sheet1.set_row(0,None,bold)
# sheet1.set_column('A:A', None, forma_decimal)

# sheet1.set_row(0,None,'#,##0.00')


# sht.Cells(row, col).Font.Size = 15#字体大小  
# sht.Cells(row, col).Font.Bold = True#是否黑体  
# sht.Cells(row, col).Name = "Arial"#字体类型  
# sht.Cells(row, col).Interior.ColorIndex = 3#表格背景  
# #sht.Range("A1").Borders.LineStyle = xlDouble  
# sht.Cells(row, col).BorderAround(1,4)#表格边框  
# sht.Rows(3).RowHeight = 30#行高  
# sht.Cells(row, col).HorizontalAlignment = -4131 #水平居中xlCenter  
# sht.Cells(row, col).VerticalAlignment = -4160 #  





print("========完成在工作表：  < "  + bookname+ ">  " + "写入sheet  <" +  sheetname +">")
# =======================FIRST   END=================





# #=+++++++++++++++++++++SECOND START=====================

# sheetname = r'光纤部HE每小时累计使用量'
# print("=======start write sheet    ="+sheetname)

# sql2 = """
# SELECT
#  	* 
# FROM
#  	IHTODB.TBL_IHTODB a 
# WHERE
#  	a.Date_time BETWEEN to_date( '2020-12-20 00:00:00', 'YYYY-MM-DD HH24:MI:SS' ) 
#  	AND to_date( SYSDATE+1) 
#     AND to_char( Date_time, 'MI' ) = '10' /*烘房温度*/
#  	AND ( tag_index = 134 ) 
# ORDER BY
#  	date_time ASC,
#  	tag_index ASC


# """

# ## =======================执行SQL

# cursor.execute(sql2)
# alldata = cursor.fetchall() 
# # print(row)
# print("========SUCCESS to get alldata from oracle =========",sheetname)


# # ====================查询结果写入excel
# t = time.strftime('%Y.%m.%d',time.localtime(time.time()))
# # print(t)


# # print(bookname)

# # book = xlsxwriter.Workbook(bookname)
# sheet2 = book.add_worksheet(sheetname)
#   # Add a bold format to use to highlight cells. 设置粗体，默认是False
# bold = book.add_format({'bold': True})
#   # Add a number format for cells with money.  定义数字格式
# money = book.add_format({'num_format': '$#,##0'})
#   # Add a number format for cells with money.  定义日期格式
# date_format = book.add_format({'num_format': 'd mmmm yyyy'})



# fields = [field[0] for field in cursor.description]  # 获取所有字段名    
# # print(fields)
# for col,field in enumerate(fields):
# #     print(col,field)
#     sheet2.write(0,col,field,forma)
# print ("========success 完成写表头=========")    

# row = 1
# for data in alldata:
#     #print(data)
# #     print ("d%",row) 
#     for col,field in enumerate(data):
#         sheet2.write(row,col,field,forma)
#         #print(type(row))
#         #print（row）
#         #print（col）
#         #print（field）
#     row += 1
# #     print("========cesssfsff=========")

# # sheet.set_column(1,None,forma)
# sheet2.set_column("A:Z", 15)    #设置列宽度
# sheet2.set_row(0, 10)    #设置行高度
# # format = book.add_format({'color':'red'})    #获取单元格属性
# #{'bold': True, 'font_size': 14, 'align': 'center','valign': 'vcenter','border':1, 'color':'red', 'bg_color':'blue'}
# dir(format)    #可以显示属性的种类
# # format.set_bold("A:A")    #设置粗体
# sheet2.set_row(0,None,bold)

# print("========完成在工作表：  < "  + bookname+ ">  " + "写入sheet  <" +  sheetname +">")
# # =======================SECOND END=============










# #=++++++++++++++++++++3START=====================

# sheetname = r'光纤部每8小时温度'
# print("=======start write "+sheetname+"到excel")

# sql_sheet3= '''
# SELECT 
# A.TAG_INDEX,
# A.TAG_NAME,
# A.TAG_DESC,
# A.DATE_TIME,
# A.VALUE,
# A.VALUE_STATUS
# FROM
# IHTODB.TBL_IHTODB A
# WHERE
# A.DATE_TIME BETWEEN to_date(sysdate-7) AND to_date(sysdate+1) AND
# to_char(date_time,'MI') = '59' AND
# mod(to_number(to_char(date_time,'HH24')),8) = 0 
# AND
# A.TAG_DESC LIKE '%温度%' 
# ORDER BY
# A.DATE_TIME ASC,
# A.TAG_INDEX ASC

# '''

# ## =======================执行SQL

# cursor.execute(sql_sheet3)
# alldata = cursor.fetchall() 
# # print(row)
# print("========SUCCESS to get alldata from oracle =========",sheetname)


# # ====================查询结果写入excel
# t = time.strftime('%Y.%m.%d',time.localtime(time.time()))
# # print(t)


# # print(bookname)

# # book = xlsxwriter.Workbook(bookname)
# sheet3 = book.add_worksheet(sheetname)
#   # Add a bold format to use to highlight cells. 设置粗体，默认是False
# bold = book.add_format({'bold': True})
#   # Add a number format for cells with money.  定义数字格式
# money = book.add_format({'num_format': '$#,##0'})
#   # Add a number format for cells with money.  定义日期格式
# date_format = book.add_format({'num_format': 'd mmmm yyyy'})



# fields = [field[0] for field in cursor.description]  # 获取所有字段名    
# # print(fields)
# for col,field in enumerate(fields):
# #     print(col,field)
#     sheet3.write(0,col,field,forma)
# print ("========success 完成写表头=========")    

# row = 1
# for data in alldata:
#     #print(data)
# #     print ("d%",row) 
#     for col,field in enumerate(data):
#         sheet3.write(row,col,field,forma)
#         #print(type(row))
#         #print（row）
#         #print（col）
#         #print（field）
#     row += 1
# #     print("========cesssfsff=========")

# # sheet.set_column(1,None,forma)
# sheet3.set_column("A:Z", 15)    #设置列宽度
# sheet3.set_row(0, 10)    #设置行高度
# # format = book.add_format({'color':'red'})    #获取单元格属性
# #{'bold': True, 'font_size': 14, 'align': 'center','valign': 'vcenter','border':1, 'color':'red', 'bg_color':'blue'}
# dir(format)    #可以显示属性的种类
# # format.set_bold("A:A")    #设置粗体
# sheet3.set_row(0,None,bold)

# print("========完成在工作表：  < "  + bookname+ ">  " + "写入sheet  <" +  sheetname +">")
# # =======================3 END=============


# #=++++++++++++++++++++4START=====================

# sheetname = r'光纤部每8小时湿度数据'
# print("=======start write sheet    ="+sheetname)

# sql4 = '''

# SELECT 

# A.TAG_INDEX,
# A.TAG_NAME,
# A.TAG_DESC,
# A.DATE_TIME,
# A.VALUE,
# A.VALUE_STATUS
# FROM
# IHTODB.TBL_IHTODB A
# WHERE
# A.DATE_TIME BETWEEN to_date(sysdate-7) AND to_date(sysdate+1) AND
# to_char(date_time,'MI') = '59' AND
# mod(to_number(to_char(date_time,'HH24')),8) = 0 
# AND
# A.TAG_DESC LIKE '%湿度%' 
# ORDER BY
# A.DATE_TIME ASC,
# A.TAG_INDEX ASC

# '''



# ## =======================执行SQL

# cursor.execute(sql4)
# alldata = cursor.fetchall() 
# # print(row)
# print("========SUCCESS to get alldata from oracle =========",sheetname)


# # ====================获取系统时间
# t = time.strftime('%Y.%m.%d',time.localtime(time.time()))
# # print(t)


# # print(bookname)

# # book = xlsxwriter.Workbook(bookname)
# sheet4 = book.add_worksheet(sheetname)
#   # Add a bold format to use to highlight cells. 设置粗体，默认是False
# bold = book.add_format({'bold': True})
#   # Add a number format for cells with money.  定义数字格式
# money = book.add_format({'num_format': '$#,##0'})
#   # Add a number format for cells with money.  定义日期格式
# date_format = book.add_format({'num_format': 'd mmmm yyyy'})



# fields = [field[0] for field in cursor.description]  # 获取所有字段名    
# # print(fields)
# for col,field in enumerate(fields):
# #     print(col,field)
#     sheet4.write(0,col,field,forma)
# print ("========success 完成写表头=========")    

# row = 1
# for data in alldata:
#     #print(data)
# #     print ("d%",row) 
#     for col,field in enumerate(data):
#         sheet4.write(row,col,field,forma)
#         #print(type(row))
#         #print（row）
#         #print（col）
#         #print（field）
#     row += 1
# #     print("========cesssfsff=========")

# # sheet.set_column(1,None,forma)
# sheet4.set_column("A:Z", 15 )    #设置列宽度
# sheet4.set_row(0, 10)    #设置行高度
# # format = book.add_format({'color':'red'})    #获取单元格属性
# #{'bold': True, 'font_size': 14, 'align': 'center','valign': 'vcenter','border':1, 'color':'red', 'bg_color':'blue'}
# # dir(format)    #可以显示属性的种类
# # format.set_bold("A:A")    #设置粗体
# sheet4.set_row(0,None,bold)

# print("========完成在工作表：  < "  + bookname+ ">  " + "写入sheet  <" +  sheetname +">")
# # =======================3 END=============














cursor.close()   
connection.close()
xlBook.SaveAs(pwd + '\\demo'+ t+ str(ran) + '.xlsx')
xlApp.Visible = 1
xlApp.Workbooks.Open(pwd + '\\demo'+ t+ str(ran) + '.xlsx')

# xlApp.Quit() # exit app

print("========close db,close workbook,SUCCESS all！=========")



